<app-page-header
  title="Securty"
  title1="Profiles"
  activeitem="Forms"
></app-page-header>

<div class="box-body">
  <div class="col-span-12 md:col-span-6 xxl:!col-span-4 mt-5 box">
      <div class="box-header">
        <h5 class="box-title">Profile</h5>
      </div>
      <div class="box-body">
        <form class="ti-validation" [formGroup]="ProfileForm">
          <div class="grid lg:grid-cols-2 gap-6">
            <!-- Colonne de gauche -->
            <div>
              <div class="space-y-2">
                <label class="block font-medium text-gray-700 dark:text-gray-300">Profile Name</label>
                <input
                  type="text"
                  formControlName="profileLabel"
                  class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white dark:focus:ring-blue-500 dark:placeholder-gray-400"
                  placeholder="Label"
                />
                <div
                  *ngIf="ProfileForm.controls['profileLabel'].invalid && (ProfileForm.controls['profileLabel'].dirty || ProfileForm.controls['profileLabel'].touched)"
                  class="text-red-500 text-sm"
                >
                  Profile Name is required.
                </div>
              </div>

              <div class="space-y-2 mt-4">
                <label class="block font-medium text-gray-700 dark:text-gray-300">Code</label>
                <input
                  type="text"
                  formControlName="profileCode"
                  class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white dark:focus:ring-blue-500 dark:placeholder-gray-400"
                  placeholder="your@site.com"
                />
                <div
                  *ngIf="ProfileForm.controls['profileCode'].invalid && (ProfileForm.controls['profileCode'].dirty || ProfileForm.controls['profileCode'].touched)"
                  class="text-red-500 text-sm"
                >
                  Code is required.
                </div>
              </div>

              <div class="space-y-2 mt-4">
                <label class="block font-medium text-gray-700 dark:text-gray-300">Privilege Level</label>
                <div class="flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2">
                  <label class="flex items-center px-3 py-2 border border-gray-300 dark:border-gray-600 rounded cursor-pointer dark:bg-gray-700 dark:text-white">
                    <input
                      id="profileLevel-1"
                      name="profileLevel"
                      type="radio"
                      class="mr-2"
                      required
                      formControlName="profileLevel"
                      value="3"
                    />
                    <span>Most High</span>
                  </label>
                  <label class="flex items-center px-3 py-2 border border-gray-300 dark:border-gray-600 rounded cursor-pointer dark:bg-gray-700 dark:text-white">
                    <input
                      id="profileLevel-2"
                      name="profileLevel"
                      type="radio"
                      class="mr-2"
                      formControlName="profileLevel"
                      value="2"
                    />
                    <span>High</span>
                  </label>
                  <label class="flex items-center px-3 py-2 border border-gray-300 dark:border-gray-600 rounded cursor-pointer dark:bg-gray-700 dark:text-white">
                    <input
                      id="profileLevel-3"
                      name="profileLevel"
                      type="radio"
                      class="mr-2"
                      formControlName="profileLevel"
                      value="1"
                      checked
                    />
                    <span>Normal</span>
                  </label>
                </div>
              </div>
            </div>

            <!-- Colonne de droite -->
            <div class="active-profile">
              <div class="space-y-2">
                <div class="grid sm:grid-cols-2 gap-2">
                  <label class="flex items-center px-3 py-2 border border-gray-300 dark:border-gray-600 rounded cursor-pointer dark:bg-gray-700 dark:text-white">
                    <input
                      type="checkbox"
                      class="mr-2"
                      id="hs-checkbox-in-form"
                      formControlName="profileState"
                    />
                    <span class="text-sm text-gray-500 dark:text-gray-300">Actived Profile</span>
                  </label>
                </div>
              </div>
              <div class="space-y-2 mt-4">
                <label class="block font-medium text-gray-700 dark:text-gray-300">Description</label>
                <textarea
                  id="message"
                  rows="5"
                  class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white dark:focus:ring-blue-500 dark:placeholder-gray-400"
                  placeholder="Write your thoughts here..."
                  formControlName="profileDescription"
                ></textarea>
                <div
                  *ngIf="ProfileForm.controls['profileLabel'].invalid && (ProfileForm.controls['profileLabel'].dirty || ProfileForm.controls['profileLabel'].touched)"
                  class="text-red-500 text-sm"
                >
                  Profile Name is required.
                </div>
              </div>
            </div>
          </div>
        </form>
      </div>
  </div>

  <div class="col-span-12 md:col-span-6 xxl:!col-span-4 mt-5">
    <div class="box">
      <div class="box-header grid lg:grid-cols-12 gap-12 w-full ">
        <div class=" col-span-6 md:col-span-6 xxl:!col-span-6 mt-5">
          <h5 class="box-title ">Permission access</h5>
        </div>
        <div class=" col-span-6 md:col-span-6 xxl:!col-span-6 mt-5 flex justify-end">
          <input type="checkbox" class="ti-form-checkbox mt-0.5 mx-5" (change)="onCheckboxChangeAll($event)" />
        </div>
      </div>
      <div class="box-body">
        <div class="sm:border-b border-gray-200 dark:border-white/10">
          <nav
            class="-mb-0.5 sm:flex sm:space-x-6 rtl:space-x-reverse overflow-x-auto"
          >
            <a
              *ngFor="let module of modules; let i = index"
              (click)="setActiveTab(i)"
              [class.active-tab]="activeTabIndex === i"
              class="tab text-sm whitespace-nowrap text-gray-500 dark:text-white/70 hover:text-primary"
            >
              <svg
                class="w-3.5 h-3.5"
                xmlns="http://www.w3.org/2000/svg"
                width="16"
                height="16"
                fill="currentColor"
                viewBox="0 0 16 16"
              >
                <path
                  fill-rule="evenodd"
                  d="M2 13.5V7h1v6.5a.5.5 0 0 0 .5.5h9a.5.5 0 0 0 .5-.5V7h1v6.5a1.5 1.5 0 0 1-1.5 1.5h-9A1.5 1.5 0 0 1 2 13.5zm11-11V6l-2-2V2.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5z"
                />
                <path
                  fill-rule="evenodd"
                  d="M7.293 1.5a1 1 0 0 1 1.414 0l6.647 6.646a.5.5 0 0 1-.708.708L8 2.207 1.354 8.854a.5.5 0 1 1-.708-.708L7.293 1.5z"
                />
              </svg>
              {{ module.moduleLabel }}
            </a>
          </nav>
        </div>
        <div class="mt-3">
          <div
            *ngFor="let module of modules; let i = index"
            [class.hidden]="activeTabIndex !== i"
            role="tabpanel"
          >
            <div *ngFor="let menu of module.menus">
              <div class="box mb-0 mt-0 rounded-none">
                <div class="box-header bg-gray-200 w-100 h-100 grid lg:grid-cols-12 gap-6 ">
                  <div class=" col-span-6 md:col-span-6 xxl:!col-span-6 mt-5">
                    <h5 class="box-title ">{{ menu.menuLabel }} </h5>
                  </div>
                  <div class=" col-span-12 md:col-span-6 xxl:!col-span-6 mt-5 flex justify-end">
                    <input type="checkbox" class="ti-form-checkbox mt-0.5"
                    (change)="onCheckboxMenu($event,menu.menuLabel??'',menu.subMenus??[])"
                    />
                  </div>
                </div>
                <div class="box-body">
                  <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div
                      class="flex items-center space-x-2"
                      *ngFor="let page of menu.subMenus"
                    >
                      <input
                        type="checkbox"
                        class="ti-form-checkbox mt-0.5"
                        [attr.id]="menu.menuLabel=='Others'?'men-checkbox-group-' + page.subMenuID:'sub-checkbox-group-' + page.subMenuID"
                        [checked]="page.subMenuState"
                        (change)="
                          onCheckboxChange(
                            $event,
                            page.subMenuID ?? 0,
                            menu.menuLabel ?? ''
                          )
                        "
                        [attr.value]="page.subMenuID"
                      />
                      <label
                        [attr.for]="'hs-checkbox-group-' + page.subMenuID"
                        class="text-sm text-gray-500 ltr:ml-2 rtl:mr-2 dark:text-white/70"
                      >
                        {{ page.subMenuLabel }}
                      </label>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <button (click)="Submit()" class="ti-btn ti-btn-primary floating-button">
    Add Profile
  </button>
</div>
